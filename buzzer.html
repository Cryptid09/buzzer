<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Buzzer System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Anton&family=Roboto:wght@400;700&display=swap');
        
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .title {
            font-family: 'Anton', sans-serif;
            letter-spacing: 1px;
        }
        
        .buzzer {
            transition: all 0.2s ease;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .buzzer:active {
            transform: scale(0.95);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .winner-flash {
            animation: winnerFlash 0.5s infinite alternate;
        }
        
        @keyframes winnerFlash {
            from { background-color: #10B981; }
            to { background-color: #059669; }
        }
        
        .leaderboard-entry {
            transition: all 0.3s ease;
        }
        
        .new-winner {
            animation: newWinner 1s ease;
        }
        
        @keyframes newWinner {
            0% { transform: scale(1); background-color: #fff; }
            50% { transform: scale(1.05); background-color: #10B981; color: white; }
            100% { transform: scale(1); background-color: #fff; }
        }
        
        .modal {
            transition: opacity 0.3s ease;
        }
        
        .admin-panel {
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body class="text-gray-100 min-h-screen flex flex-col">
    <!-- Header -->
    <header class="container mx-auto px-4 py-6 text-center">
        <h1 class="title text-4xl md:text-5xl text-yellow-400 mb-2">QUIZ BUZZER</h1>
        <p class="text-lg text-gray-300">Fastest finger wins! Connect via local network</p>
        <button id="admin-login-btn" class="mt-4 bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg">
            <i class="fas fa-lock mr-2"></i>Admin Login
        </button>
    </header>

    <main class="flex-1 container mx-auto px-4 py-6">
        <!-- Game State & Admin Controls -->
        <div class="bg-blue-900/50 rounded-xl p-6 mb-8 shadow-lg">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                <div>
                    <h2 class="text-2xl font-bold text-yellow-400">Game Controls</h2>
                    <p class="text-gray-300" id="game-status">Status: Buzzer Locked</p>
                </div>
                <div class="flex gap-4">
                    <button id="reset-btn" class="bg-red-600 hover:bg-red-700 px-6 py-3 rounded-lg font-semibold transition">
                        Reset Buzzers
                    </button>
                    <button id="start-btn" class="bg-green-600 hover:bg-green-700 px-6 py-3 rounded-lg font-semibold transition">
                        Start Buzzer
                    </button>
                    <button id="lock-btn" class="bg-yellow-600 hover:bg-yellow-700 px-6 py-3 rounded-lg font-semibold transition">
                        Lock Buzzers
                    </button>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Buzzer Section -->
            <div class="lg:col-span-2">
                <div class="bg-blue-900/50 rounded-xl p-6 shadow-lg h-full">
                    <h2 class="text-2xl font-bold text-yellow-400 mb-6 text-center">Buzzer</h2>
                    
                    <div class="flex flex-col items-center justify-center">
                        <div class="relative w-64 h-64 md:w-80 md:h-80 mb-8">
                            <div id="buzzer" class="buzzer w-full h-full bg-gray-600 rounded-full flex items-center justify-center cursor-not-allowed">
                                <span class="text-white text-2xl md:text-3xl font-bold">BUZZ LOCKED</span>
                            </div>
                            <div id="timer" class="absolute -bottom-8 left-1/2 transform -translate-x-1/2 text-xl font-bold text-yellow-400">
                                0.000s
                            </div>
                        </div>
                        
                        <div class="w-full max-w-md">
                            <div class="flex items-center justify-between mb-4">
                                <label for="player-name" class="text-lg">Your Name:</label>
                                <input type="text" id="player-name" placeholder="Enter your name" class="bg-blue-800/50 border border-blue-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-400">
                            </div>
                            <button id="register-btn" class="w-full bg-green-600 hover:bg-green-700 py-3 rounded-lg font-semibold transition">
                                Register Player
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Leaderboard Section -->
            <div>
                <div class="bg-blue-900/50 rounded-xl p-6 shadow-lg h-full">
                    <h2 class="text-2xl font-bold text-yellow-400 mb-6 text-center">Leaderboard</h2>
                    
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-yellow-300 mb-2">Current Winner</h3>
                        <div id="current-winner" class="bg-blue-800/50 rounded-lg p-4 text-center">
                            <div class="text-gray-300">No winner yet</div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-lg font-semibold text-yellow-300 mb-2">Top Players</h3>
                        <div id="leaderboard" class="space-y-3">
                            <div class="text-gray-300 text-center">No scores yet</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Connected Players -->
        <div class="mt-8 bg-blue-900/50 rounded-xl p-6 shadow-lg">
            <h2 class="text-2xl font-bold text-yellow-400 mb-4 text-center">Connected Players</h2>
            <div id="connected-players" class="flex flex-wrap gap-3 justify-center">
                <div class="bg-gray-600/50 rounded-lg px-4 py-2">No players connected</div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="container mx-auto px-4 py-6 text-center text-gray-400 mt-8">
        <p>Quiz Buzzer System - Hosted locally on your network</p>
    </footer>

    <!-- Admin Login Modal -->
    <div id="admin-modal" class="fixed inset-0 bg-black/70 flex items-center justify-center z-50 hidden modal">
        <div class="admin-panel bg-gray-800 rounded-xl p-8 w-full max-w-md">
            <h2 class="text-2xl font-bold text-yellow-400 mb-6 text-center">Admin Login</h2>
            <div class="mb-6">
                <label for="admin-username" class="block text-lg mb-2">Username:</label>
                <input type="text" id="admin-username" placeholder="Admin" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-yellow-400">
            </div>
            <div class="mb-6">
                <label for="admin-password" class="block text-lg mb-2">Password:</label>
                <input type="password" id="admin-password" placeholder="Enter password" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-yellow-400">
            </div>
            <div class="flex gap-4">
                <button id="admin-cancel" class="flex-1 bg-gray-600 hover:bg-gray-500 py-3 rounded-lg font-semibold transition">
                    Cancel
                </button>
                <button id="admin-login" class="flex-1 bg-green-600 hover:bg-green-700 py-3 rounded-lg font-semibold transition">
                    Login
                </button>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
const socket = io();

// DOM elements
const buzzer = document.getElementById('buzzer');
const timer = document.getElementById('timer');
const resetBtn = document.getElementById('reset-btn');
const lockBtn = document.getElementById('lock-btn');
const startBtn = document.getElementById('start-btn');
const gameStatus = document.getElementById('game-status');
const playerNameInput = document.getElementById('player-name');
const registerBtn = document.getElementById('register-btn');
const currentWinner = document.getElementById('current-winner');
const leaderboard = document.getElementById('leaderboard');
const connectedPlayers = document.getElementById('connected-players');
const adminLoginBtn = document.getElementById('admin-login-btn');
const adminModal = document.getElementById('admin-modal');
const adminCancel = document.getElementById('admin-cancel');
const adminLogin = document.getElementById('admin-login');
const adminUsername = document.getElementById('admin-username');
const adminPassword = document.getElementById('admin-password');

let myName = null;
let myAdmin = false;

// Receive game state from server
socket.on('state', (state) => {
    updateUI(state);
});

// Register player
registerBtn.addEventListener('click', () => {
    const name = playerNameInput.value.trim();
    if (!name) return alert("Please enter a name!");
    myName = name;
    socket.emit('register', name);
});

// Admin login
adminLoginBtn.addEventListener('click', () => adminModal.classList.remove('hidden'));
adminCancel.addEventListener('click', () => adminModal.classList.add('hidden'));
adminLogin.addEventListener('click', () => {
    socket.emit('admin-login', {
        username: adminUsername.value.trim(),
        password: adminPassword.value.trim()
    });
});
socket.on('admin-login-success', () => {
    myAdmin = true;
    adminModal.classList.add('hidden');
});
socket.on('admin-login-fail', () => alert('Invalid admin credentials!'));

// Admin controls
startBtn.addEventListener('click', () => myAdmin && socket.emit('start-buzzer'));
lockBtn.addEventListener('click', () => myAdmin && socket.emit('lock-buzzers'));
resetBtn.addEventListener('click', () => myAdmin && socket.emit('reset-buzzers'));

// Buzzer press
buzzer.addEventListener('click', () => {
    if (!myName) return alert("Please enter your name first!");
    socket.emit('buzz', myName);
});

// Update UI based on state
function updateUI(state) {
    // Game status
    gameStatus.textContent = state.buzzersLocked ? 'Status: Buzzer Locked' : 'Status: Buzzer Active - Press Now!';
    // Buzzer button
    if (state.buzzersLocked) {
        buzzer.className = "buzzer w-full h-full bg-gray-600 rounded-full flex items-center justify-center cursor-not-allowed";
        buzzer.innerHTML = '<span class="text-white text-2xl md:text-3xl font-bold">BUZZ LOCKED</span>';
    } else {
        buzzer.className = "buzzer w-full h-full bg-red-600 rounded-full flex items-center justify-center cursor-pointer pulse";
        buzzer.innerHTML = '<span class="text-white text-2xl md:text-3xl font-bold">BUZZ NOW!</span>';
    }
    // Timer
    timer.textContent = state.startTime && state.winner ? 
        state.players[state.winner].buzzTime.toFixed(3) + 's' : '0.000s';
    // Winner
    currentWinner.innerHTML = state.winner ?
        `<div class="winner-flash rounded-lg p-2 font-bold">${state.winner} - ${state.players[state.winner].buzzTime.toFixed(3)}s</div>` :
        '<div class="text-gray-300">No winner yet</div>';
    // Leaderboard
    leaderboard.innerHTML = state.leaderboard.length ? state.leaderboard.map((entry, i) =>
        `<div class="leaderboard-entry bg-blue-800/50 rounded-lg p-3 flex justify-between">
            <span>${i+1}. ${entry.name}</span>
            <span class="text-yellow-400">${entry.buzzTime.toFixed(3)}s</span>
        </div>`
    ).join('') : '<div class="text-gray-300 text-center">No scores yet</div>';
    // Connected players
    const players = Object.keys(state.players);
    connectedPlayers.innerHTML = players.length ? players.map(p =>
        `<div class="bg-green-600/50 rounded-lg px-4 py-2">${p}</div>`
    ).join('') : '<div class="bg-gray-600/50 rounded-lg px-4 py-2">No players connected</div>';
    // Admin controls
    [resetBtn, startBtn, lockBtn].forEach(btn => {
        btn.classList.toggle('opacity-50', !state.adminLoggedIn);
        btn.classList.toggle('cursor-not-allowed', !state.adminLoggedIn);
    });
    if (state.adminLoggedIn) {
        adminLoginBtn.innerHTML = '<i class="fas fa-user-cog mr-2"></i>Admin';
        adminLoginBtn.classList.add('bg-yellow-600', 'hover:bg-yellow-700');
        adminLoginBtn.classList.remove('bg-gray-700', 'hover:bg-gray-600');
    } else {
        adminLoginBtn.innerHTML = '<i class="fas fa-lock mr-2"></i>Admin Login';
        adminLoginBtn.classList.remove('bg-yellow-600', 'hover:bg-yellow-700');
        adminLoginBtn.classList.add('bg-gray-700', 'hover:bg-gray-600');
    }
}
    </script>
</body>
</html>